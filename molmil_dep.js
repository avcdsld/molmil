/*!
 * molmil_dep.js
 *
 * Molmil molecular web viewer: https://github.com/gjbekker/molmil
 * 
 * By Gert-Jan Bekker
 * License: LGPLv3
 *   See https://github.com/gjbekker/molmil/blob/master/LICENCE.md
 */
;var molmil_dep=molmil_dep||{};molmil_dep.staticHOST="";molmil_dep.fontSize=16;try{document.body.style.fontSize="";molmil_dep.fontSize=Number(getComputedStyle(document.body,"").fontSize.match(/(\d*(\.\d*)?)px/)[1])}catch(e){molmil_dep.fontSize=16}molmil_dep.Strip=function(a,b){return a.replace(/^\s+|\s+$/g,"")};molmil_dep.isTouchDevice=function(){try{var a=document.createElement("DIV");a.setAttribute("ongesturestart","return;");return typeof a.ongesturestart=="function"}catch(b){return false}};molmil_dep.dBT=new function(){this.MSIE=false;this.MFF=false;this.GC=false;this.ASF=false;this.OO=false;this.internal=false;this.webkit=false;this.gecko=false;this.presto=false;this.mobile=false;this.denyASYNC=false;this.touchBased=false;this.GWP=false;this.mac=false;this.slow=false;this.name="Unknown";this.language="en";this.unknownBrowser=false;this.majorVersion=0;this.minorVersion=0;this.ios_version=null;this.featureSupport={};try{this.featureSupport.svg=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}catch(c){this.featureSupport.svg=false}var a="0.0";if(navigator.userAgent.indexOf("MSIE")!=-1){this.MSIE=true;this.name="Microsoft Internet Explorer";a=navigator.userAgent.split("MSIE")[1].split(";")[0]}else{if(navigator.userAgent.indexOf("Trident")!=-1){this.MSIE=true;this.name="Microsoft Internet Explorer";a=navigator.userAgent.split("rv:")[1]}else{if(navigator.userAgent.indexOf("Firefox")!=-1){this.MFF=true;this.name="Mozilla Firefox";this.gecko=true;a=navigator.userAgent.split("Firefox/")[1]}else{if(navigator.userAgent.indexOf("Chrome")!=-1){this.GC=true;this.name="Google Chrome";this.webkit=true;a=molmil_dep.Strip(navigator.userAgent.split("Chrome/")[1].split(" ")[0])}else{if(navigator.userAgent.indexOf("phantomJS_hijax")!=-1){this.GC=true;this.name="PhantomJS";this.webkit=true;a="20";useHistoryAPI=false;this.denyASYNC=true;this.internal=true;this.slow=true}else{if(navigator.userAgent.indexOf("CriOS")!=-1){this.GC=true;this.name="Google Chrome";this.webkit=true;a=molmil_dep.Strip(navigator.userAgent.split("CriOS/")[1].split(" ")[0])}else{if(navigator.userAgent.indexOf("Android")!=-1){this.GC=true;this.webkit=true;a=molmil_dep.Strip(navigator.userAgent.split("AppleWebKit/")[1].split(" ")[0])}else{if(navigator.userAgent.indexOf("Opera")!=-1){this.OO=true;this.name="Opera";this.presto=true;a=navigator.userAgent.split("Version/")[1]}else{if(navigator.userAgent.indexOf("Safari")!=-1){this.ASF=true;this.name="Apple Safari";this.webkit=true;a=navigator.userAgent.split("Version/")[1]}}}}}}}}}if(navigator.userAgent.toLowerCase().indexOf("mobile")!=-1||navigator.userAgent.toLowerCase().indexOf("android")!=-1||navigator.msMaxTouchPoints){this.mobile=true}if(this.webkit&&navigator.userAgent.indexOf("Google Web Preview")!=-1){this.denyASYNC=true;this.GWP=true}if(navigator.userAgent.indexOf("Googlebot")!=-1){this.webkit=true;this.denyASYNC=true;this.GWP=true}if(navigator.userLanguage){this.language=navigator.userLanguage.toLowerCase()}else{if(navigator.language){this.language=navigator.language.toLowerCase()}}if(navigator.userAgent.indexOf("Mac")!=-1){this.mac=true}else{if(navigator.language){this.language=navigator.language}}if(!a){a="0.0"}this.majorVersion=parseInt(a.split(".")[0]);this.minorVersion=parseInt(a.split(".")[1]);this.version=parseFloat(this.majorVersion+"."+this.minorVersion);if(navigator.userAgent.indexOf("like Mac OS X")!=-1){try{var b=(navigator.userAgent.split(" OS ")[1].split(" ")[0].split("_"));this.ios_version=b[0]+"."+b[1]}catch(c){this.ios_version=0}}if(this.mobile){this.slow=true}try{this.crossDomainScripting=("withCredentials" in new XMLHttpRequest())}catch(c){this.crossDomainScripting=false}this.secureHTTP=false;if(!this.webkit&&!this.gecko&&!this.MSIE&&!this.OO){this.unknownBrowser=true}this.touchBased=molmil_dep.isTouchDevice();if(this.MFF&&this.majorVersion<4){this.featureSupport.svg=false}};molmil_dep.CallRemote=function(b,a){this.formData=null;this.request=null;this.Method=b;this.parameters=[];if(b=="POSTv2"&&typeof(FormData)!="undefined"){this.formData=new FormData()}else{if(b=="POSTv2"){this.Method="POST"}}this.ASYNC=false;this.ctype="application/x-www-form-urlencoded";this.responseType=null;this.forceSSL=false;this.initRequest(a)};molmil_dep.CallRemote.prototype.initRequest=function(c){var a=molmil_dep.dBT.MSIE&&molmil_dep.dBT.majorVersion<10;if(c&&molmil_dep.dBT.MSIE&&molmil_dep.dBT.majorVersion<10&&typeof(XDomainRequest)!="undefined"){a=false;this.request=new XDomainRequest();this.Method="POST"}else{this.request=new XMLHttpRequest()}this.request.XHRO=this.request;var b=this.request.CRO=this;this.request.ERROR=false;this.request.loadHandler=function(){if(this.CRO.VirtualOnDone){this.CRO.VirtualOnDone()}if(this.status&&this.status>399){this.ERROR=true}if(this.CRO.OnDone){try{if(!this.ERROR){this.CRO.OnDone()}}catch(d){this.ERROR=d}if(this.ERROR){if(this.CRO.OnError){this.CRO.OnError()}else{if(!this.silent){console.error(this.ERROR.stack)}throw this.ERROR}}}};if(this.request.onload==null&&!a){this.request.onload=this.request.loadHandler}else{this.request.onreadystatechange=function(){if(this.readyState!=4){return false}this.loadHandler()}}if(molmil_dep.dBT.MSIE&&typeof(XDomainRequest)!="undefined"&&this instanceof XDomainRequest){this.request.onload=this.request.onreadystatechange}};molmil_dep.CallRemote.prototype.AddParameter=function(a,b){if(this.Method=="POSTv2"){this.formData.append(a,b)}else{this.parameters+=(this.parameters.length?"&":"")+a+"="+encodeURIComponent(b)}};molmil_dep.CallRemote.prototype.AddParameters=function(b){for(var a=0;a<b.length;a++){this.AddParameter(b[a][0],b[a][1])}};molmil_dep.CallRemote.prototype.Send=function(a,b){if(this.forceSSL){a=a.replace("http://","https://")}if(molmil_dep.dBT.MSIE&&molmil_dep.dBT.majorVersion<10){var d=a.split("/");for(var c=0;c<d.length;c++){if(d[c].indexOf(".")!=-1){d=d[c];break}}if(d!=document.domain){this.initRequest(true)}}if(molmil_dep.dBT.denyASYNC){this.ASYNC=false}if(this.Method=="GET"){this.request.open("GET",a+(this.parameters.length?"?"+this.parameters:""),this.ASYNC);if(this.responseType){this.request.responseType=this.responseType}this.request.send(null)}else{if(this.Method=="POST"){this.request.open("POST",a,this.ASYNC);try{this.request.setRequestHeader("Content-Type",this.ctype)}catch(f){}if(this.responseType){this.request.responseType=this.responseType}this.request.send((this.parameters.length?this.parameters:null))}else{if(this.Method=="POSTv2"&&this.formData){this.request.open("POST",a,this.ASYNC);if(this.responseType){this.request.responseType=this.responseType}this.request.send(this.formData)}else{if(this.Method=="HEAD"){this.request.open("HEAD",a,this.ASYNC);this.request.send(null)}}}}this.request.silent=b};molmil_dep.CallRemote.prototype.getURL=function(a){return a+(this.parameters.length?"?"+this.parameters:"")};molmil_dep.getKeyFromObject=function(c,b,a){return b in c?c[b]:a};molmil_dep.$=function(a){return document.getElementById(a)};molmil_dep.dcE=function(a){return document.createElement(a)};molmil_dep.dcEi=function(c,a){var b=document.createElement(c);b.innerHTML=a;return b};molmil_dep.isNumber=function(a){return !isNaN(parseFloat(a))&&isFinite(a)};molmil_dep.Partition=function(b,a){var c=["","",""];var d=b.indexOf(a);if(d==-1){c[0]=b}else{c[0]=b.substr(0,d);c[1]=a;c[2]=b.substr(d+1)}return c};molmil_dep.Clear=function(a){if(a&&a.hasChildNodes()){while(a.childNodes.length>0){a.removeChild(a.firstChild)}}};molmil_dep.expandCatTree=function(b,a){var c=this.parentNode;if(typeof(c.kids)=="undefined"){c.kids=c.pushNode("DIV");c.kids.style.display="none";c.kids.expandableTarget=c.expandableTarget;c.expandFunc(c.kids,c.payload);c.kids.style.marginLeft="1.25em"}if(a){return}if(c.kids.style.display=="none"){c.plus.innerHTML="-";c.kids.style.display=""}else{c.plus.innerHTML="+";c.kids.style.display="none"}if(c.expandableTarget){c.expandableTarget.contentBox.style.height=c.expandableTarget.contentBox.firstChild.clientHeight+"px"}};molmil_dep.initCheck=function(){if(molmil.configBox.initFinished){return}if(!window.glMatrix){return}if(!window.CIFparser){return}molmil.configBox.initFinished=true};molmil_dep.init=function(){if(!window.molmil.configBox||molmil.configBox.initFinished){return}var f=["gl-matrix-min.js","cif.js","FileSaver.js"],d;var c=document.getElementsByTagName("head")[0];for(var b=0;b<f.length;b++){d=molmil_dep.dcE("script");d.src=molmil.settings.src+f[b];d.onload=molmil_dep.initCheck;c.appendChild(d)}var a=["molmil.css"];for(var b=0;b<a.length;b++){d=document.createElement("link");d.rel="StyleSheet";d.href=molmil.settings.src+a[b];d=c.appendChild(d)}};molmil_dep.findPos=function(b){var a=0;var c=0;if(b.offsetParent){a+=b.offsetLeft;c+=b.offsetTop;while(b=b.offsetParent){a+=b.offsetLeft;c+=b.offsetTop}}return[a,c]};molmil_dep.asyncStart=function(c,b,a,d){return setTimeout(function(){c.apply(a,b)},d?d:0)};molmil_dep.focusOnTextEnd=function(b){try{if(typeof b.selectionStart=="number"){b.selectionStart=b.selectionEnd=b.value.length}else{if(typeof b.createTextRange!="undefined"){b.focus();var a=b.createTextRange();a.collapse(false);a.select()}}}catch(c){}};molmil_dep.Rounding=function(b,a){a=Math.pow(10,a);return Math.round(b*a)/a};molmil_dep.strRounding=function(d,a){var b=molmil_dep.Rounding(d,a)+"";if(a>0){if(b.indexOf(".")==-1){b+="."}else{a-=b.split(".")[1].length}for(var c=0;c<a;c++){b+="0"}}return b};Element.prototype.setClass=function(a){if(this.className.indexOf(a)==-1){this.className+=" "+a}};Element.prototype.removeClass=function(a){this.className=this.className.replace(new RegExp("\\b"+a+"\\b","g"),"").trim()};Element.prototype.switchClass=function(b,a){tmp=this.className.replace(new RegExp("\\b"+b+"\\b","g"),a);if(tmp==this.className){this.setClass(a)}else{this.className=tmp}};Element.prototype.pushNode=function(c,b,a){if(typeof(c)=="string"){if(c==""){return this.appendChild(document.createTextNode(b))}else{var d=this.appendChild(molmil_dep.dcE(c))}}else{var d=this.appendChild(c)}if(b){d.innerHTML=b}if(a){d.className=a}return d};if(!Array.unique){Array.prototype.unique=function(){var d={},b,a=this.length,c=[];for(b=0;b<a;b+=1){d[this[b]]=this[b]}for(b in d){c.push(d[b])}return c}}molmil_dep.init();